



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Aggregated Medicare documentation in a single place">
      
      
        <link rel="canonical" href="https://kylebarron.github.io/medicare-documentation/kyle/extract_data/">
      
      
        <meta name="author" content="Kyle Barron">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.0">
    
    
      
        <title>Data Extraction Overview - Medicare Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.aa3de92b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,400i,700|Fira+Code">
        <style>body,input{font-family:"Nunito Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Code","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="orange" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#extracting-data" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://kylebarron.github.io/medicare-documentation/" title="Medicare Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">local_library</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Medicare Documentation
              </span>
              <span class="md-header-nav__topic">
                Data Extraction Overview
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/kylebarron/medicare-documentation/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      medicare-documentation
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../NBER_website/1_Overview/" title="NBER Documentation" class="md-tabs__link">
          NBER Documentation
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../resdac/mbsf/" title="ResDAC Documentation" class="md-tabs__link">
          ResDAC Documentation
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../goals-for-modern-data-format/" title="Working with the Data" class="md-tabs__link md-tabs__link--active">
          Working with the Data
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../mauricio/enrollment-restrictions/" title="Important Details" class="md-tabs__link">
          Important Details
        </a>
      
    </li>
  

      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">local_library</i>
      
    </span>
    Medicare Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/kylebarron/medicare-documentation/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      medicare-documentation
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      NBER Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        NBER Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/1_Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/2_Background/" title="Description of Claims Files" class="md-nav__link">
      Description of Claims Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/3_Getting_started_with_SAS/" title="Getting Started with SAS" class="md-nav__link">
      Getting Started with SAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/4_constructing_extracts/" title="Constructing Extracts with SAS" class="md-nav__link">
      Constructing Extracts with SAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/5_manipulating_medicare_extracts/" title="Manipulating Extracts with SAS" class="md-nav__link">
      Manipulating Extracts with SAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/6_costs/" title="Generating Costs Measures" class="md-nav__link">
      Generating Costs Measures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/7_references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/8_appendix/" title="Appendix" class="md-nav__link">
      Appendix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Variable Names Crosswalk
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        Variable Names Crosswalk
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../NBER_website/opxw/" title="Outpatient" class="md-nav__link">
      Outpatient
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      ResDAC Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        ResDAC Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/mbsf/" title="Beneficiary Summary File" class="md-nav__link">
      Beneficiary Summary File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/carrier-rif/" title="Carrier RIF" class="md-nav__link">
      Carrier RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/denominator-rif/" title="Denominator RIF" class="md-nav__link">
      Denominator RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/dme-rif/" title="Durable Medical Equipment RIF" class="md-nav__link">
      Durable Medical Equipment RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/hha-rif/" title="Home Health Agency RIF" class="md-nav__link">
      Home Health Agency RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/hospice-rif/" title="Hospice RIF" class="md-nav__link">
      Hospice RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/ip-rif/" title="Inpatient RIF" class="md-nav__link">
      Inpatient RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/medpar-rif/" title="MedPAR RIF" class="md-nav__link">
      MedPAR RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/op-rif/" title="Outpatient RIF" class="md-nav__link">
      Outpatient RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/snf-rif/" title="Skilled Nursing Facility RIF" class="md-nav__link">
      Skilled Nursing Facility RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-11" type="checkbox" id="nav-3-11">
    
    <label class="md-nav__link" for="nav-3-11">
      Variable Definitions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-11">
        Variable Definitions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/variables/" title="All Files" class="md-nav__link">
      All Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/mbsf/" title="Beneficiary Summary File" class="md-nav__link">
      Beneficiary Summary File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/carrier-rif/" title="Carrier RIF" class="md-nav__link">
      Carrier RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/dme-rif/" title="Durable Medical Equipment RIF" class="md-nav__link">
      Durable Medical Equipment RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/hha-rif/" title="Home Health Agency RIF" class="md-nav__link">
      Home Health Agency RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/hospice-rif/" title="Hospice RIF" class="md-nav__link">
      Hospice RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/ip-rif/" title="Inpatient RIF" class="md-nav__link">
      Inpatient RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/medpar-rif/" title="MedPAR RIF" class="md-nav__link">
      MedPAR RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/op-rif/" title="Outpatient RIF" class="md-nav__link">
      Outpatient RIF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resdac/variables/snf-rif/" title="Skilled Nursing Facility RIF" class="md-nav__link">
      Skilled Nursing Facility RIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Working with the Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Working with the Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../goals-for-modern-data-format/" title="Goals for New Data Format" class="md-nav__link">
      Goals for New Data Format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../01medicare_readme/" title="Standard Readme" class="md-nav__link">
      Standard Readme
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Data Extraction Overview
      </label>
    
    <a href="./" title="Data Extraction Overview" class="md-nav__link md-nav__link--active">
      Data Extraction Overview
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stata" title="Stata" class="md-nav__link">
    Stata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" title="Python" class="md-nav__link">
    Python
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#official-documentation" title="Official Documentation" class="md-nav__link">
    Official Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sas" title="SAS" class="md-nav__link">
    SAS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r" title="R" class="md-nav__link">
    R
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r-from-dta" title="R from .dta" class="md-nav__link">
    R from .dta
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-file-formats" title="Other file formats" class="md-nav__link">
    Other file formats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmarking" title="Benchmarking" class="md-nav__link">
    Benchmarking
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stata_1" title="Stata" class="md-nav__link">
    Stata
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_locations/" title="Data Locations" class="md-nav__link">
      Data Locations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../using-tmux-aging-servers/" title="Using tmux for long-running jobs" class="md-nav__link">
      Using tmux for long-running jobs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Important Details
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Important Details
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mauricio/enrollment-restrictions/" title="Enrollment Restrictions" class="md-nav__link">
      Enrollment Restrictions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mauricio/lag-post-event-spending/" title="Calculating Costs for Inpatient Visits" class="md-nav__link">
      Calculating Costs for Inpatient Visits
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stata" title="Stata" class="md-nav__link">
    Stata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" title="Python" class="md-nav__link">
    Python
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#official-documentation" title="Official Documentation" class="md-nav__link">
    Official Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sas" title="SAS" class="md-nav__link">
    SAS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r" title="R" class="md-nav__link">
    R
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r-from-dta" title="R from .dta" class="md-nav__link">
    R from .dta
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-file-formats" title="Other file formats" class="md-nav__link">
    Other file formats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmarking" title="Benchmarking" class="md-nav__link">
    Benchmarking
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stata_1" title="Stata" class="md-nav__link">
    Stata
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/kylebarron/medicare-documentation/blob/master/docs/kyle/extract_data.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="extracting-data">Extracting Data<a class="headerlink" href="#extracting-data" title="Permanent link">&para;</a></h1>
<p><strong>What's the best, fastest way to import data?</strong></p>
<h2 id="stata">Stata<a class="headerlink" href="#stata" title="Permanent link">&para;</a></h2>
<p>Stata is what I use most, and I'm really comfortable with it, but its big limitation is that it needs everything to be in memory. Therefore, it's logical to want to try to break up analyzing a big dataset into smaller pieces. If a dataset is 50 GB in size, I wanted to be able to read in the dataset 5GB at a time. However, apparently Stata is really slow at importing data from a <code>.dta</code> file by row. Just importing the first row from an 82 GB file took <strong>18 minutes</strong>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>.<span class="k"> local</span> filename <span class="s">&quot;/disk/aging/medicare/data/limited_variables/raw_harmonized/100pct/op/op100_clms_raw_2010.dta&quot;</span>
.<span class="k"> set</span> rmsg<span class="k"> on</span>
r; t=<span class="m">0.00</span> <span class="m">16</span>:<span class="m">38</span>:<span class="m">28</span>
.<span class="k"> use</span> <span class="s">&quot;</span><span class="nv">`filename&#39;</span><span class="s">&quot;</span><span class="k"> in</span> <span class="m">1</span>,<span class="k"> clear</span>
r; t=<span class="m">1106.30</span> <span class="m">16</span>:<span class="m">57</span>:<span class="m">09</span>
.<span class="k"> di</span> <span class="m">1100</span>/<span class="m">60</span>
<span class="m">18.333333</span>
</pre></div>
</td></tr></table>

<p>This means that:</p>
<ul>
<li>It could be more time consuming to prototype data extracts with Stata or</li>
<li>I could have to change code between prototyping and the actual extract on the 100% sample</li>
</ul>
<p>I don't want to have to change code between prototyping and the actual extract because it wouldn't be difficult to introduce a simple mistake that I wouldn't find out about for a long time.</p>
<h2 id="python">Python<a class="headerlink" href="#python" title="Permanent link">&para;</a></h2>
<p>My current (December 2017) solution is to use Python. Python is able to read Stata files (i.e. <code>.dta</code> format). Helpfully, Python is also able to read only a given subset of columns, and it's able to iterate over the entire dataset, reading only chunks of data in at a time.</p>
<p>You can read in an entire Stata file with</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;filename.dta&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>You can read in a selection of variables from a Stata dataset with</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;filename.dta&#39;</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">,</span> <span class="s1">&#39;var3&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p>To read in a number of rows at a time, you create an <em>iterator</em>, and then make a for loop with commands to do to each chunk of a given number of rows. For example, the following imports 10,000 rows at a time, and will do all the commands in <code>do_something(chunk)</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">itr</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;filename.dta&#39;</span><span class="p">,</span> <span class="n">chunksize</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">itr</span><span class="p">:</span>
    <span class="n">do_something</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>When prototyping, it helps to code interactively, so you can run</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">itr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">chunksize</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">itr</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">chunk</span>
    <span class="k">break</span>
</pre></div>
</td></tr></table>

<p>This puts the first 1,000 rows in <code>df</code>. <strong>Don't forget <code>break</code>!</strong> If you forget <code>break</code>, Python will import your whole dataset, and not return control to you until it's completely finished. You don't want to remove <code>break</code> until you want to run your code on the full dataset. Then you can work interactively with <code>df</code>, and just move the code inside the loop once you're ready to run it on the entire dataset iteratively.</p>
<h3 id="official-documentation">Official Documentation<a class="headerlink" href="#official-documentation" title="Permanent link">&para;</a></h3>
<p>Pandas' documentation on reading files from Stata is <a href="https://pandas.pydata.org/pandas-docs/stable/io.html#io-stata-reader">here</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_stata.html">here</a>.</p>
<p>See <a href="https://pandas.pydata.org/pandas-docs/stable/io.html#io-perf">here</a> for benchmarks for writing and reading with Pandas in an array of formats.</p>
<h2 id="sas">SAS<a class="headerlink" href="#sas" title="Permanent link">&para;</a></h2>
<p>SAS is meant for</p>
<h2 id="r">R<a class="headerlink" href="#r" title="Permanent link">&para;</a></h2>
<h3 id="r-from-dta">R from .dta<a class="headerlink" href="#r-from-dta" title="Permanent link">&para;</a></h3>
<h2 id="other-file-formats">Other file formats<a class="headerlink" href="#other-file-formats" title="Permanent link">&para;</a></h2>
<h2 id="benchmarking">Benchmarking<a class="headerlink" href="#benchmarking" title="Permanent link">&para;</a></h2>
<h3 id="stata_1">Stata<a class="headerlink" href="#stata_1" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">use</span> bene_id clm_id icd_dgns_cd* using <span class="s">&quot;/disk/aging/medicare/data/limited_variables/raw_harmonized/100pct/op/op100_clms_raw_2012.dta&quot;</span>,<span class="k"> clear</span>
r; t=<span class="m">6942.52</span> <span class="m">3</span>:<span class="m">19</span>:<span class="m">32</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>&gt; ls -lh op100_clms_raw_2012.dta
-rw-rw---- 1 daltonm dua16702 88G Jan 13  2016 op100_clms_raw_2012.dta
</pre></div>
</td></tr></table>

<p>Therefore Stata imported the data at around 12.8 MB/s (88GB * 1024 MB/GB / 6942s).</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../01medicare_readme/" title="Standard Readme" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Standard Readme
              </span>
            </div>
          </a>
        
        
          <a href="../data_locations/" title="Data Locations" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Data Locations
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9fb73e57.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../js/helpers.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
    
      
    
  </body>
</html>